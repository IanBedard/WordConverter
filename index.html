<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Word Converter - Modern UI</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <!-- Custom Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <link href="./style.css" rel="stylesheet">
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="bi bi-magic me-2"></i>Converter Tools
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">

                    <li class="nav-item">
                        <a class="nav-link active" href="#">
                            <i class="bi bi-file-code me-1"></i>DOCX → HTML
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./excel-converter.html">
                            <i class="bi bi-table me-1"></i>XLSX → JSON
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Header Section -->
        <div class="header-section">
            <h1 class="app-title">
                <i class="bi bi-file-word text-primary me-2"></i>Word to HTML Converter
            </h1>
            <p class="app-subtitle">
                Transform your Word documents into clean, semantic HTML with advanced formatting options and real-time preview.
            </p>
            
            <div class="modern-alert warning">
                <i class="bi bi-exclamation-triangle-fill"></i>
                <span>Note: This application currently doesn't support documents containing images.</span>
            </div>
        </div>

        <!-- File Upload Section -->
        <div class="upload-section">
            <div class="file-input-wrapper">
                <input type="file" id="document" class="file-input" accept=".docx,.doc">
                <div class="file-input-button" id="file-input-display">
                    <i class="bi bi-cloud-upload fs-2"></i>
                    <div>
                        <div class="fw-bold">Choose a Word document</div>
                        <div class="small">Drag and drop or click to browse (.docx, .doc)</div>
                    </div>
                </div>
            </div>
            
            <div class="progress-container">
                <div class="progress">
                    <div class="progress-bar" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="status-message status-success" id="success-message">
                <i class="bi bi-check-circle-fill"></i>
                <span>Document processed successfully!</span>
            </div>
            
            <div class="status-message status-error" id="error-message">
                <i class="bi bi-exclamation-circle-fill"></i>
                <span>Error processing document. Please try again.</span>
            </div>
        </div>

        <!-- Tabs -->
        <div class="custom-tabs">
            <ul class="nav nav-tabs" id="outputTabs">
                <li class="nav-item">
                    <button class="nav-link active" id="code-tab" data-bs-toggle="tab" data-bs-target="#code-pane">
                        <i class="bi bi-code-slash me-2"></i>HTML Code
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" id="preview-tab" data-bs-toggle="tab" data-bs-target="#preview-pane">
                        <i class="bi bi-eye me-2"></i>Live Preview
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings-pane">
                        <i class="bi bi-gear me-2"></i>Settings
                    </button>
                </li>
            </ul>
        </div>

        <!-- Tab Content -->
        <div class="tab-content">
            <!-- HTML Code Tab -->
            <div class="tab-pane fade show active" id="code-pane">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h4 class="mb-0">
                        <i class="bi bi-code-slash text-primary me-2"></i>Generated HTML Code
                    </h4>
                    <div class="action-buttons">
                        <button class="btn-modern btn-secondary-modern" id="format-code">
                            <i class="bi bi-braces"></i>Format Code
                        </button>
                        <button class="btn-modern btn-primary-modern" id="copy-txt">
                            <i class="bi bi-clipboard"></i>Copy Code
                        </button>
                    </div>
                </div>
                <textarea 
                    class="form-control code-editor" 
                    id="html-data" 
                    rows="20" 
                    placeholder="Your generated HTML code will appear here..."
                    spellcheck="false"
                ></textarea>
            </div>

            <!-- Live Preview Tab -->
            <div class="tab-pane fade" id="preview-pane">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h4 class="mb-0">
                        <i class="bi bi-eye text-primary me-2"></i>Live Preview
                    </h4>
                    <div class="action-buttons">
                        <button class="btn-modern btn-secondary-modern" id="refresh-preview">
                            <i class="bi bi-arrow-clockwise"></i>Refresh
                        </button>
               
                    </div>
                </div>
                <div class="preview-container" id="output">
                    <div class="text-center text-muted py-5">
                        <i class="bi bi-file-text fs-1 mb-3 d-block"></i>
                        <p>Upload a Word document to see the preview here</p>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-pane fade" id="settings-pane">
                <h4 class="mb-4">
                    <i class="bi bi-gear text-primary me-2"></i>Processing Options
                </h4>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card border-0 shadow-sm mb-4">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <i class="bi bi-type text-primary me-2"></i>Text Processing
                                </h5>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="auto-h2" checked>
                                    <label class="form-check-label" for="auto-h2">
                                        Auto-process H2 headings
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="create-toc" checked>
                                    <label class="form-check-label" for="create-toc">
                                        Create table of contents links
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="clean-empty-tags" checked>
                                    <label class="form-check-label" for="clean-empty-tags">
                                        Remove empty HTML tags
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card border-0 shadow-sm mb-4">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <i class="bi bi-palette text-primary me-2"></i>Styling Options
                                </h5>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="bootstrap-tables" checked>
                                    <label class="form-check-label" for="bootstrap-tables">
                                        Apply Bootstrap table styling
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="preserve-formatting">
                                    <label class="form-check-label" for="preserve-formatting">
                                        Preserve original formatting
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="semantic-html" checked>
                                    <label class="form-check-label" for="semantic-html">
                                        Use semantic HTML elements
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="action-buttons justify-content-center">
                    <button class="btn-modern btn-primary-modern" id="h2button">
                        <i class="bi bi-play-circle"></i>Process H2 Headings
                    </button>
                    <button class="btn-modern btn-secondary-modern" id="reset-settings">
                        <i class="bi bi-arrow-counterclockwise"></i>Reset to Defaults
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
    
    <script>
        // Enhanced UI interactions
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('document');
            const fileInputDisplay = document.getElementById('file-input-display');
            const progressContainer = document.querySelector('.progress-container');
            const progressBar = document.querySelector('.progress-bar');
            const successMessage = document.getElementById('success-message');
            const errorMessage = document.getElementById('error-message');

            // File input handling
            fileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    fileInputDisplay.classList.add('has-file');
                    fileInputDisplay.innerHTML = `
                        <i class="bi bi-file-earmark-check fs-2"></i>
                        <div>
                            <div class="fw-bold">${file.name}</div>
                            <div class="small">${(file.size / 1024 / 1024).toFixed(2)} MB</div>
                        </div>
                    `;
                    showProgress();
                } else {
                    resetFileInput();
                }
            });

            // Drag and drop functionality
            fileInputDisplay.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.style.borderColor = 'var(--primary-color)';
                this.style.background = 'rgba(99, 102, 241, 0.05)';
            });

            fileInputDisplay.addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.style.borderColor = 'var(--border-color)';
                this.style.background = 'var(--light-color)';
            });

            fileInputDisplay.addEventListener('drop', function(e) {
                e.preventDefault();
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    fileInput.files = files;
                    fileInput.dispatchEvent(new Event('change'));
                }
                this.style.borderColor = 'var(--border-color)';
                this.style.background = 'var(--light-color)';
            });

            // Copy button with modern feedback
            document.getElementById('copy-txt').addEventListener('click', async function() {
                const htmlData = document.getElementById('html-data').value;
                if (!htmlData) {
                    showToast('No content to copy', 'warning');
                    return;
                }

                try {
                    await navigator.clipboard.writeText(htmlData);
                    showToast('Code copied to clipboard!', 'success');
                    this.innerHTML = '<i class="bi bi-check"></i>Copied!';
                    setTimeout(() => {
                        this.innerHTML = '<i class="bi bi-clipboard"></i>Copy Code';
                    }, 2000);
                } catch (err) {
                    showToast('Failed to copy to clipboard', 'error');
                }
            });

            // Format code button
            document.getElementById('format-code').addEventListener('click', function() {
                const textarea = document.getElementById('html-data');
                if (textarea.value) {
                    // Trigger reformatting through the processor
                    showToast('Code formatted!', 'success');
                }
            });

            // Refresh preview button
            document.getElementById('refresh-preview').addEventListener('click', function() {
                const htmlData = document.getElementById('html-data').value;
                document.getElementById('output').innerHTML = htmlData || 
                    '<div class="text-center text-muted py-5"><i class="bi bi-file-text fs-1 mb-3 d-block"></i><p>No content to preview</p></div>';
            });

            // Reset settings button
            document.getElementById('reset-settings').addEventListener('click', function() {
                document.querySelectorAll('#settings-pane input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = checkbox.hasAttribute('checked');
                });
                showToast('Settings reset to defaults', 'info');
            });

            function showProgress() {
                progressContainer.style.display = 'block';
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 30;
                    if (progress > 100) {
                        progress = 100;
                        clearInterval(interval);
                        setTimeout(() => {
                            progressContainer.style.display = 'none';
                            showSuccess();
                        }, 500);
                    }
                    progressBar.style.width = progress + '%';
                }, 200);
            }

            function showSuccess() {
                successMessage.style.display = 'flex';
                setTimeout(() => {
                    successMessage.style.display = 'none';
                }, 5000);
            }

            function resetFileInput() {
                fileInputDisplay.classList.remove('has-file');
                fileInputDisplay.innerHTML = `
                    <i class="bi bi-cloud-upload fs-2"></i>
                    <div>
                        <div class="fw-bold">Choose a Word document</div>
                        <div class="small">Drag and drop or click to browse (.docx, .doc)</div>
                    </div>
                `;
            }

            function showToast(message, type = 'info') {
                const toast = document.createElement('div');
                toast.className = `position-fixed top-0 end-0 m-3 p-3 rounded shadow toast-${type}`;
                toast.style.zIndex = '9999';
                toast.style.background = type === 'success' ? 'var(--success-color)' : 
                                       type === 'error' ? 'var(--danger-color)' : 
                                       type === 'warning' ? 'var(--warning-color)' : 'var(--primary-color)';
                toast.style.color = 'white';
                toast.textContent = message;
                
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.remove();
                }, 3000);
            }
        });
    </script>
    
    <!-- Your existing script.js will be loaded here -->
    <script src="script.js"></script>
</body>
</html>